# Nginx Configuration for MAX Platform Frontend Cache Control
# Place this in your nginx server block

location ~* \.(html|htm)$ {
    # HTML files should never be cached
    add_header Cache-Control "no-cache, no-store, must-revalidate";
    add_header Pragma "no-cache";
    add_header Expires "0";
}

location ~* \.(js|css)$ {
    # Static assets with version-based cache busting
    # Cache for 1 year if filename contains hash
    if ($uri ~* "\.([a-zA-Z0-9]{8})\.(js|css)$") {
        add_header Cache-Control "public, max-age=31536000, immutable";
    }
    
    # No cache for non-hashed files (development)
    if ($uri !~* "\.([a-zA-Z0-9]{8})\.(js|css)$") {
        add_header Cache-Control "no-cache, must-revalidate";
    }
}

location ~* \.(jpg|jpeg|png|gif|ico|svg|woff|woff2|ttf|eot)$ {
    # Images and fonts - cache for 30 days
    add_header Cache-Control "public, max-age=2592000";
}

# Force cache refresh for specific paths during deployment
location = /clear-cache {
    add_header Clear-Site-Data "cache";
    return 200 "Cache cleared";
}